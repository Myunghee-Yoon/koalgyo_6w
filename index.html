<!DOCTYPE html>
<html>
  <head>
    <title>Form 테스트1</title>
    <style>
      h3 {
        text-align: center;
      }
      .container {
        display: flex;
        /* justify-content: space-around; */
        justify-content: center;
        /* text-align: center; */
        margin: 10px;
        padding: 10px;
      }
      #form1 {
        background-color: yellow;
        width: 300px;
        margin: 10px;
        padding: 10px;
      }
      #form2 {
        background-color: aqua;
        width: 300px;
        margin: 10px;
        padding: 10px;
      }
    </style>
    <script>
   function submitForm1(event) {
          event.preventDefault();

          // Google Apps Script 웹 앱 URL (반드시 본인의 URL로 교체해야 합니다)
          const webAppUrl = "https://script.google.com/macros/s/AKfycbzfC_FXdQn7eaZasV7v5sQEeZ-lI2epLbHX8bnrcGNlg4U3hate60hJqf2u8BdMG1_M/exec"; // <--- 여기에 배포된 웹 앱 URL을 넣으세요!

          const email = document.getElementById("form1_email_id").value;
          const name = document.getElementById("form1_name_id").value;
          const message = document.getElementById("form1_message_id").value;
          const study = document.getElementById("form1_study_id").value; // 추가된 input에서 값 가져오기

          let seminar = '';
          if (document.getElementById("form1_seminar_id1").checked) {
            seminar = document.getElementById("form1_seminar_id1").value;
          } else if (document.getElementById("form1_seminar_id2").checked) {
            seminar = document.getElementById("form1_seminar_id2").value;
          }
          const subject = document.getElementById("form1_subject_id").value;

          // fetch 요청 본문 구성 (key 이름은 Apps Script의 e.parameter에서 사용할 이름과 일치해야 함)
          const formData = new URLSearchParams();
          formData.append('email', email);
          formData.append('name', name);
          formData.append('message', message);
          formData.append('study', study);
          formData.append('seminar', seminar);
          formData.append('subject', subject);

          fetch(webAppUrl, { // URL 변수 사용
              method: "POST",
              // mode: "no-cors", // no-cors 모드는 응답을 받지 못하게 하므로, 성공/실패 확인이 어렵습니다.
                                // Apps Script에서 ContentService를 사용하면 CORS 문제가 발생하지 않습니다.
              headers: {
                  // "Content-Type": "application/x-www-form-urlencoded" // URLSearchParams 사용 시 불필요
              },
              body: formData // URLSearchParams 객체 사용
          })
          .then(response => response.text()) // 응답을 텍스트로 변환
          .then(result => {
              console.log("Success:", result); // 성공 응답 로그 (Apps Script에서 보낸 "Success")
              alert("정보가 성공적으로 전송되었습니다!");
              // document.getElementById("form1_id").reset(); // 성공 시 폼 초기화 (선택 사항)
          })
          .catch(error => {
              console.error("Error:", error);
              alert("전송 실패: " + error.message);
          });
      }
  </script>
  
  </head>
  <h3>WebForm을 사용해봅시다</h3>
  <div class="container">
    <div id="form1">
      <form id="form1_id" onsubmit="submitForm1(event)">
        <fieldset>
          <legend>G-DEAL 화이팅</legend>
          <label for="email">이메일:<br>
            <input type="email" id="form1_email_id"placeholder="id@gmail.com" required>
          </label><br>
          
          <label>이름:<br>
            <input type="text" id="form1_name_id" name="form1_name_name" placeholder="하윤종" required>
          </label><br>

          <label>오늘의 수업은 어떠셨나요<br>
            <textarea rows=4 id="form1_message_id" name="form1_message_name" required>다들 좋은 시간이었기를 바랍니다.</textarea>
          </label><br>

          일요일이 즐겁다:<br>
          <label>네<input type="radio" name="form1_seminar_name" id="form1_seminar_id1" value="네"></label><br>
          <label>아니요<input type="radio" name="form1_seminar_name"  id="form1_seminar_id2" value="아니요"></label><br>
          <br>

          앞으로 추가로 배우시고 싶은 내용은?: : <br>
          <select name="form1_subject_name" id="form1_subject_id">
              <option value="웹프로그래밍">웹프로그래밍</option>
              <option value="앱스스크립트">앱스스크립트</option>
              <option value="인공지능">인공지능</option>
          </select><br><br>
          <button type="submit">제출</button>
        </fieldset>
      </form>
    </div>
  </div>
</html>
